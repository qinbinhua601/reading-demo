<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>reading process collision</title><style>p.large{font-size:36px}p.medium{font-size:24px}p.small{font-size:16px}table{border-collapse:collapse;width:100%;font-family:arial,sans-serif;box-shadow:20px 0 10px #00000080}td,th{text-align:left;border:1px solid #ddd;padding:8px}tr:nth-child(2n){background-color:#ddd}.doc{width:600px;outline:1px solid red;margin:0 auto}.reading{width:100px;height:30px;background-color:#00f;position:fixed;bottom:10px}.reading2{width:100px;height:30px;color:#fff;text-align:center;background-color:#00f;font-size:14px;line-height:30px;transition:left .1s ease-in-out,width .1s ease-in-out;position:fixed;bottom:10px}.rect{min-height:200px;outline:1px solid #00f;margin-top:100px}.rect:hover{cursor:pointer}.rect.rect1{margin-left:-50px;margin-right:-50px}.rect.rect2{margin-left:-100px;margin-right:-100px}.rect.rect3{margin-left:-150px;margin-right:-150px}.rect.rect4{margin-left:-200px;margin-right:-200px}.rect.rect5{margin-left:-250px;margin-right:-250px}.rect.rect6{margin-left:-300px;margin-right:-300px}.rect.rect7{margin-left:-350px;margin-right:-350px}.rect.rect8{margin-left:-400px;margin-right:-400px}</style><script src="/index.8d5545d2.js"></script></head><body> <ol> <li>You can input the SIZE and click the start button to change the number of the super width elements</li> <li>You can click the super width elements to change its width type</li> </ol> <label for="size">SIZE (e.g. 50, 100, 200...)</label> <input type="text" id="size" value="50"> <button onclick="start()">start</button> <div class="reading" style="opacity:0;pointer-events:none"></div> <div class="reading2">阅读进度</div> <div class="doc"></div> <script>const SIZE=30,pTypes=["small","medium","large"];function initDoc(t=100){let e="";for(let n=0;n<t;n++){const t=_.random(1,8);e+=`\n        ${_.random(0,1)?`<p class="${pTypes[_.random(0,2)]}">Lorem ipsum dolor sit amet consectetur adipisicing elit. Ducimus at recusandae repellendus adipisci laudantium expedita, sunt est! Velit autem voluptatem minima blanditiis reiciendis, illum provident, cupiditate, maiores assumenda amet rem.</p>`:""}\n        <div class="rect rect${t}">\n          <table>\n            <tr>\n              <th>Company</th>\n              <th>Contact</th>\n              <th>Country</th>\n            </tr>\n            <tr>\n              <td>Alfreds Futterkiste</td>\n              <td>Maria Anders</td>\n              <td>Germany</td>\n            </tr>\n            <tr>\n              <td>Centro comercial Moctezuma</td>\n              <td>Francisco Chang</td>\n              <td>Mexico</td>\n            </tr>\n            <tr>\n              <td>Ernst Handel</td>\n              <td>Roland Mendel</td>\n              <td>Austria</td>\n            </tr>\n            <tr>\n              <td>Island Trading</td>\n              <td>Helen Bennett</td>\n              <td>UK</td>\n            </tr>\n            <tr>\n              <td>Laughing Bacchus Winecellars</td>\n              <td>Yoshi Tannamuri</td>\n              <td>Canada</td>\n            </tr>\n            <tr>\n              <td>Magazzini Alimentari Riuniti</td>\n              <td>Giovanni Rovelli</td>\n              <td>Italy</td>\n            </tr>\n          </table>\n        </div>\n        `}document.querySelector(".doc").innerHTML=e}function intersectRect(t,e){return!(e.left>=t.right||e.right<=t.left||e.top>=t.bottom||e.bottom<=t.top)}function hasBlocked(t){const e=Array.from(document.querySelectorAll(".rect"));for(let n=0;n<e.length;n++){const r=e[n].getBoundingClientRect();if(console.log(r),intersectRect(r,t))return r}return null}function start(){const t=_.throttle((()=>{const t=document.querySelector(".doc").getBoundingClientRect(),e=document.querySelector(".reading"),n=document.querySelector(".reading2"),r=e.getBoundingClientRect(),i=hasBlocked(r);if(console.log(i),i){if(i.left<200)return n.style.width="50px",n.innerText="进度",w=50,void(n.style.left="0");n.style.left=i.left-r.width+"px"}else t.left>=200&&(n.style.width="100px",n.innerText="阅读进度"),n.style.left=t.left-r.width+"px"}),100,{trailing:!0,leading:!0}),e=+document.querySelector("#size").value;console.log("qin",e),initDoc(e||30),document.addEventListener("scroll",t),(()=>{const t=document.querySelector(".doc").getBoundingClientRect(),e=document.querySelector(".reading"),n=e.getBoundingClientRect();e.style.left=t.left-n.width+"px"})(),t();const n=new MutationObserver((e=>{t()}));n.observe(document.querySelector(".doc"),{attributes:!0,childList:!0,characterData:!0}),document.querySelectorAll(".rect").forEach((t=>{t.addEventListener("click",(()=>{const e=t.classList.value.split(" ")[1]||`rect${_.random(1,8)}`;console.log("qin",e),t.classList.toggle(e)})),n.observe(t,{attributes:!0})}))}start();</script> </body></html>